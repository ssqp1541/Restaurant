# REFACTOR λ‹¨κ³„ 3λ‹¨κ³„ μ™„λ£ λ¦¬ν¬νΈ
## μ•„ν‚¤ν…μ² κ°μ„  - λ μ΄μ–΄ λ¶„λ¦¬ λ° μ„¤κ³„ ν¨ν„΄ μ μ©

**μ‘μ„±μΌ**: 2025λ…„ 12μ›” 19μΌ  
**λ‹¨κ³„**: TDD REFACTOR - 3λ‹¨κ³„: μ•„ν‚¤ν…μ² κ°μ„   
**μƒνƒ**: β… μ™„λ£

---

## π“‹ μ‘μ—… κ°μ”

REFACTOR λ‹¨κ³„μ 3λ‹¨κ³„μΈ "μ•„ν‚¤ν…μ² κ°μ„ "μ„ μ™„λ£ν–μµλ‹λ‹¤. λ μ΄μ–΄λ¥Ό λ¶„λ¦¬ν•κ³  Repository, Factory, Strategy ν¨ν„΄μ„ μ μ©ν•μ—¬ ν™•μ¥ κ°€λ¥ν•κ³  μ μ§€λ³΄μν•κΈ° μ‰¬μ΄ μ•„ν‚¤ν…μ²λ΅ κ°μ„ ν–μµλ‹λ‹¤.

---

## β… μ™„λ£λ μ‘μ—…

### 1. λ μ΄μ–΄ λ¶„λ¦¬ β…

#### ν”„λ μ  ν…μ΄μ… λ μ΄μ–΄ (λΌμ°νΈ ν•Έλ“¤λ¬)
- **μ±…μ„**: μ”μ²­/μ‘λ‹µ μ²λ¦¬λ§ λ‹΄λ‹Ή
- **κµ¬ν„**: `app.py`μ Flask λΌμ°νΈ ν•Έλ“¤λ¬
- **κ°μ„  μ‚¬ν•­**:
  - λΉ„μ¦λ‹μ¤ λ΅μ§μ„ μ„λΉ„μ¤ λ μ΄μ–΄λ΅ λ¶„λ¦¬
  - λΌμ°νΈ ν•Έλ“¤λ¬λ” μ„λΉ„μ¤ λ©”μ„λ“ νΈμ¶λ§ μν–‰
  - μ”μ²­/μ‘λ‹µ λ³€ν™ λ΅μ§ λ‹¨μν™”

#### λΉ„μ¦λ‹μ¤ λ΅μ§ λ μ΄μ–΄ (μ„λΉ„μ¤)
- **μ±…μ„**: λΉ„μ¦λ‹μ¤ λ΅μ§ μ²λ¦¬
- **κµ¬ν„**: `services/` λ””λ ‰ν† λ¦¬
  - `RestaurantService`: λ§¤μ¥ λ°μ΄ν„° κ΄€λ¦¬
  - `MetricsService`: λ©”νΈλ¦­ μμ§‘ λ° κ΄€λ¦¬
  - `HealthCheckService`: ν—¬μ¤ μ²΄ν¬ λ΅μ§
- **κ°μ„  μ‚¬ν•­**:
  - Repository ν¨ν„΄μ„ μ‚¬μ©ν•μ—¬ λ°μ΄ν„° μ ‘κ·Ό λ΅μ§κ³Ό λ¶„λ¦¬
  - μμ΅΄μ„± μ£Όμ…μΌλ΅ ν…μ¤νΈ κ°€λ¥ν• κµ¬μ΅°

#### λ°μ΄ν„° μ ‘κ·Ό λ μ΄μ–΄ (λ¦¬ν¬μ§€ν† λ¦¬)
- **μ±…μ„**: λ°μ΄ν„° μ ‘κ·Ό λ΅μ§ μΊ΅μν™”
- **κµ¬ν„**: `repositories/restaurant_repository.py`
  - `IDataRepository`: λ°μ΄ν„° λ¦¬ν¬μ§€ν† λ¦¬ μΈν„°νμ΄μ¤
  - `RestaurantRepository`: νμΌ μ‹μ¤ν… κΈ°λ° κµ¬ν„
- **κ°μ„  μ‚¬ν•­**:
  - μΈν„°νμ΄μ¤ κΈ°λ° μ„¤κ³„λ΅ ν–¥ν›„ λ°μ΄ν„°λ² μ΄μ¤ μ „ν™ μ©μ΄
  - λ°μ΄ν„° μ ‘κ·Ό λ΅μ§ μΊ΅μν™”λ΅ ν…μ¤νΈ μ©μ΄μ„± ν–¥μƒ

---

### 2. μ„¤κ³„ ν¨ν„΄ μ μ© β…

#### Repository ν¨ν„΄
- **λ©μ **: λ°μ΄ν„° μ ‘κ·Ό λ΅μ§ μΊ΅μν™”
- **κµ¬ν„**:
  - `IDataRepository` μΈν„°νμ΄μ¤ μ •μ
  - `RestaurantRepository` ν΄λμ¤ κµ¬ν„
  - `load_all()`, `save_all()`, `find_by_name()`, `add()` λ©”μ„λ“ μ κ³µ
- **ν¨κ³Ό**:
  - λ°μ΄ν„° μ†μ¤ μ¶”μƒν™” (νμΌ μ‹μ¤ν… β†’ λ°μ΄ν„°λ² μ΄μ¤ μ „ν™ μ©μ΄)
  - ν…μ¤νΈ μ‹ λ¨ν‚Ή κ°€λ¥
  - λΉ„μ¦λ‹μ¤ λ΅μ§κ³Ό λ°μ΄ν„° μ ‘κ·Ό λ΅μ§ λ¶„λ¦¬

#### Factory ν¨ν„΄
- **λ©μ **: μ„λΉ„μ¤ κ°μ²΄ μƒμ„± μΊ΅μν™”
- **κµ¬ν„**:
  - `ServiceFactory` ν΄λμ¤ (`factories/service_factory.py`)
  - `create_restaurant_service()`, `create_metrics_service()`, `create_health_check_service()` λ©”μ„λ“
  - `create_all_services()` λ©”μ„λ“λ΅ λ¨λ“  μ„λΉ„μ¤ μΌκ΄„ μƒμ„±
- **ν¨κ³Ό**:
  - κ°μ²΄ μƒμ„± λ΅μ§ μ¤‘μ•™ν™”
  - μ„¤μ • κΈ°λ° κ°μ²΄ μƒμ„± κ°€λ¥
  - μμ΅΄μ„± κ΄€λ¦¬ μ©μ΄

#### Strategy ν¨ν„΄
- **λ©μ **: κ²€μ¦ λ° μ €μ¥ λ΅μ§μ„ μ μ—°ν•κ² κµμ²΄ κ°€λ¥ν•λ„λ΅ μ„¤κ³„
- **κµ¬ν„**:
  - `IValidationStrategy` μΈν„°νμ΄μ¤ λ° `RestaurantValidationStrategy` κµ¬ν„
  - `IStorageStrategy` μΈν„°νμ΄μ¤ λ° `FileStorageStrategy` κµ¬ν„
- **ν¨κ³Ό**:
  - κ²€μ¦ λ΅μ§μ„ μ „λµμΌλ΅ κµμ²΄ κ°€λ¥
  - μ €μ¥ λ΅μ§μ„ μ „λµμΌλ΅ κµμ²΄ κ°€λ¥ (νμΌ β†’ λ°μ΄ν„°λ² μ΄μ¤ λ“±)
  - ν™•μ¥μ„± ν–¥μƒ

#### Singleton ν¨ν„΄
- **λ©μ **: μ „μ—­ μƒνƒ κ΄€λ¦¬
- **κµ¬ν„**:
  - `RestaurantCache` μ‹±κΈ€ν†¤ (`utils/cache.py`)
  - `MetricsCollector` μ‹±κΈ€ν†¤ (`utils/metrics.py`)
- **ν¨κ³Ό**:
  - μ „μ—­ μƒνƒ μΌκ΄€μ„± μ μ§€
  - λ©”λ¨λ¦¬ ν¨μ¨μ„±

---

## π“ μƒμ„±λ νμΌ

### λ¦¬ν¬μ§€ν† λ¦¬ λ μ΄μ–΄
1. **`repositories/__init__.py`**
   - λ¦¬ν¬μ§€ν† λ¦¬ λ¨λ“ μ΄κΈ°ν™”

2. **`repositories/restaurant_repository.py`**
   - `IDataRepository` μΈν„°νμ΄μ¤
   - `RestaurantRepository` ν΄λμ¤

### ν©ν† λ¦¬ λ μ΄μ–΄
3. **`factories/service_factory.py`**
   - `ServiceFactory` ν΄λμ¤

### μ „λµ λ μ΄μ–΄
4. **`strategies/__init__.py`**
   - μ „λµ λ¨λ“ μ΄κΈ°ν™”

5. **`strategies/validation_strategy.py`**
   - `IValidationStrategy` μΈν„°νμ΄μ¤
   - `RestaurantValidationStrategy` ν΄λμ¤

6. **`strategies/storage_strategy.py`**
   - `IStorageStrategy` μΈν„°νμ΄μ¤
   - `FileStorageStrategy` ν΄λμ¤

---

## π”„ μμ •λ νμΌ

### `app.py`
- Factory ν¨ν„΄ μ‚¬μ©μΌλ΅ μ„λΉ„μ¤ μƒμ„± λ‹¨μν™”
- `ServiceFactory.create_all_services()` μ‚¬μ©

### `services/restaurant_service.py`
- Repository ν¨ν„΄ μ μ©
- `RestaurantRepository` μμ΅΄μ„± μ£Όμ…
- `get_restaurant_by_name()`, `add_restaurant()` λ©”μ„λ“ μ¶”κ°€

---

## π“ κ°μ„  ν¨κ³Ό

### μ•„ν‚¤ν…μ² κ°μ„ 
- β… 3κ³„μΈµ μ•„ν‚¤ν…μ² (ν”„λ μ  ν…μ΄μ…, λΉ„μ¦λ‹μ¤, λ°μ΄ν„° μ ‘κ·Ό)
- β… κ° λ μ΄μ–΄μ μ±…μ„ λ…ν™•ν™”
- β… λ μ΄μ–΄ κ°„ μμ΅΄μ„± λ°©ν–¥ λ…ν™• (ν”„λ μ  ν…μ΄μ… β†’ λΉ„μ¦λ‹μ¤ β†’ λ°μ΄ν„° μ ‘κ·Ό)

### ν™•μ¥μ„± ν–¥μƒ
- β… μΈν„°νμ΄μ¤ κΈ°λ° μ„¤κ³„λ΅ κµ¬ν„ κµμ²΄ μ©μ΄
- β… μ „λµ ν¨ν„΄μΌλ΅ μ•κ³ λ¦¬μ¦ κµμ²΄ μ©μ΄
- β… Factory ν¨ν„΄μΌλ΅ κ°μ²΄ μƒμ„± μ μ—°ν™”

### ν…μ¤νΈ μ©μ΄μ„± ν–¥μƒ
- β… μΈν„°νμ΄μ¤ κΈ°λ°μΌλ΅ λ¨ν‚Ή κ°€λ¥
- β… μμ΅΄μ„± μ£Όμ…μΌλ΅ ν…μ¤νΈ κ²©λ¦¬ κ°€λ¥
- β… κ° λ μ΄μ–΄λ¥Ό λ…λ¦½μ μΌλ΅ ν…μ¤νΈ κ°€λ¥

### μ μ§€λ³΄μμ„± ν–¥μƒ
- β… κ° λ μ΄μ–΄μ λ³€κ²½μ΄ λ‹¤λ¥Έ λ μ΄μ–΄μ— λ―ΈμΉλ” μν–¥ μµμ†ν™”
- β… ν¨ν„΄ μ μ©μΌλ΅ μ½”λ“ κµ¬μ΅° λ…ν™•ν™”
- β… μ±…μ„ λ¶„λ¦¬λ΅ μ½”λ“ μ΄ν•΄λ„ ν–¥μƒ

---

## π—οΈ μ•„ν‚¤ν…μ² λ‹¤μ΄μ–΄κ·Έλ¨

```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚   ν”„λ μ  ν…μ΄μ… λ μ΄μ–΄ (app.py)      β”‚
β”‚   - Flask λΌμ°νΈ ν•Έλ“¤λ¬             β”‚
β”‚   - μ”μ²­/μ‘λ‹µ μ²λ¦¬                  β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
               β”‚
               β–Ό
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚   λΉ„μ¦λ‹μ¤ λ΅μ§ λ μ΄μ–΄ (services/)  β”‚
β”‚   - RestaurantService               β”‚
β”‚   - MetricsService                   β”‚
β”‚   - HealthCheckService               β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
               β”‚
               β–Ό
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚   λ°μ΄ν„° μ ‘κ·Ό λ μ΄μ–΄ (repositories/)β”‚
β”‚   - RestaurantRepository            β”‚
β”‚   - IDataRepository (μΈν„°νμ΄μ¤)    β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

---

## π§ ν…μ¤νΈ μƒνƒ

### Import ν…μ¤νΈ
- β… λ¨λ“  λ¨λ“ import μ„±κ³µ
- β… Factory ν¨ν„΄ μ •μƒ μ‘λ™ ν™•μΈ
- β… Repository ν¨ν„΄ μ •μƒ μ‘λ™ ν™•μΈ
- β… Strategy ν¨ν„΄ μ •μƒ μ‘λ™ ν™•μΈ

### λ‹¤μ λ‹¨κ³„
- κ° λ μ΄μ–΄μ— λ€ν• λ‹¨μ„ ν…μ¤νΈ μ‘μ„± ν•„μ”
- ν†µν•© ν…μ¤νΈ μ—…λ°μ΄νΈ ν•„μ”

---

## π“ λ‹¤μ μ‘μ—…

### 4λ‹¨κ³„: μ½”λ“ ν’μ§ ν–¥μƒ
- [ ] νƒ€μ… μ•μ •μ„± κ°•ν™”
- [ ] μ—λ¬ μ²λ¦¬ κ°μ„ 
- [ ] λ΅κΉ… κ°μ„ 
- [ ] λ¬Έμ„ν™” κ°μ„ 

### 5λ‹¨κ³„: μ„±λ¥ μµμ ν™”
- [ ] μΊμ‹± κ°μ„ 
- [ ] λ©”λ¨λ¦¬ μµμ ν™”
- [ ] μ‘λ‹µ μ‹κ°„ μµμ ν™”

---

## β… μ²΄ν¬λ¦¬μ¤νΈ

- [x] ν”„λ μ  ν…μ΄μ… λ μ΄μ–΄ λ¶„λ¦¬
- [x] λΉ„μ¦λ‹μ¤ λ΅μ§ λ μ΄μ–΄ λ¶„λ¦¬
- [x] λ°μ΄ν„° μ ‘κ·Ό λ μ΄μ–΄ λ¶„λ¦¬
- [x] Repository ν¨ν„΄ μ μ©
- [x] Factory ν¨ν„΄ μ μ©
- [x] Strategy ν¨ν„΄ μ μ©
- [x] Singleton ν¨ν„΄ ν™•μΈ (μ΄λ―Έ κµ¬ν„λ¨)
- [x] μΈν„°νμ΄μ¤ κΈ°λ° μ„¤κ³„
- [x] μμ΅΄μ„± μ£Όμ… μ μ©

---

**λ¦¬ν¬νΈ μ‘μ„±μΌ**: 2025λ…„ 12μ›” 19μΌ  
**μ‘μ„±μ**: ν”„λ΅μ νΈ ν€  
**λ‹¤μ μ—…λ°μ΄νΈ**: μ½”λ“ ν’μ§ ν–¥μƒ ν›„

