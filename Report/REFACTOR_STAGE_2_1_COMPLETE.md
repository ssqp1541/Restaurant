# REFACTOR λ‹¨κ³„ 2.1 μ™„λ£ λ¦¬ν¬νΈ
## Single Responsibility Principle (λ‹¨μΌ μ±…μ„ μ›μΉ™) μ μ©

**μ‘μ„±μΌ**: 2025λ…„ 12μ›” 19μΌ  
**λ‹¨κ³„**: TDD REFACTOR - 2.1: Single Responsibility Principle  
**μƒνƒ**: β… μ™„λ£

---

## π“‹ μ‘μ—… κ°μ”

REFACTOR λ‹¨κ³„μ 2.1 λ‹¨κ³„μΈ "Single Responsibility Principle (λ‹¨μΌ μ±…μ„ μ›μΉ™)" μ μ©μ„ μ™„λ£ν–μµλ‹λ‹¤. μ„λΉ„μ¤ λ μ΄μ–΄λ¥Ό λ„μ…ν•μ—¬ μ±…μ„μ„ λ¶„λ¦¬ν•κ³ , μμ΅΄μ„± μ£Όμ…μ„ ν†µν•΄ ν…μ¤νΈ κ°€λ¥ν• κµ¬μ΅°λ΅ κ°μ„ ν–μµλ‹λ‹¤.

---

## β… μ™„λ£λ μ‘μ—…

### 1. ν΄λμ¤/ν•¨μ μ±…μ„ λ¶„λ¦¬ β…

#### λ¬Έμ μ 
- `app.py`μ λΌμ°νΈ ν•Έλ“¤λ¬κ°€ λΉ„μ¦λ‹μ¤ λ΅μ§μ„ μ§μ ‘ μ²λ¦¬
- λ©”νΈλ¦­ μμ§‘κ³Ό μ‘λ‹µ μƒμ„±μ΄ νΌμ¬
- ν—¬μ¤ μ²΄ν¬ λ΅μ§μ΄ λΌμ°νΈ ν•Έλ“¤λ¬μ— ν¬ν•¨

#### ν•΄κ²° λ°©λ²•
- **μ„λΉ„μ¤ λ μ΄μ–΄ λ„μ…**
  - λΉ„μ¦λ‹μ¤ λ΅μ§μ„ μ„λΉ„μ¤ ν΄λμ¤λ΅ λ¶„λ¦¬
  - λΌμ°νΈ ν•Έλ“¤λ¬λ” μ”μ²­/μ‘λ‹µ μ²λ¦¬λ§ λ‹΄λ‹Ή
  - κ° μ„λΉ„μ¤κ°€ λ‹¨μΌ μ±…μ„μ„ κ°€μ§€λ„λ΅ μ„¤κ³„

#### λ³€κ²½ μ‚¬ν•­
```python
# μ΄μ „ (app.pyμ— λ¨λ“  λ΅μ§ ν¬ν•¨)
def api_restaurants():
    metrics.increment_request()
    restaurants = _get_restaurants_data()
    ...

def health_check():
    # νμΌ μ‹μ¤ν… μ²΄ν¬
    # λ°μ΄ν„° λ΅λ“ μ²΄ν¬
    # λ©”νΈλ¦­ μ¶”κ°€
    ...

# μ΄ν›„ (μ„λΉ„μ¤ λ μ΄μ–΄λ΅ λ¶„λ¦¬)
def api_restaurants():
    metrics_service.increment_request()
    restaurants = restaurant_service.get_all_restaurants()
    ...

def health_check():
    health_metrics = metrics_service.get_health_metrics()
    health_status, status_code = health_check_service.perform_health_check(health_metrics)
    ...
```

---

### 2. μ„λΉ„μ¤ λ μ΄μ–΄ λ„μ… β…

#### μƒμ„±λ μ„λΉ„μ¤ ν΄λμ¤

1. **`RestaurantService`** (`services/restaurant_service.py`)
   - **λ‹¨μΌ μ±…μ„**: λ§¤μ¥ λ°μ΄ν„° κ΄€λ ¨ λΉ„μ¦λ‹μ¤ λ΅μ§λ§ λ‹΄λ‹Ή
   - **μ£Όμ” λ©”μ„λ“**:
     - `get_all_restaurants()`: λ¨λ“  λ§¤μ¥ λ°μ΄ν„° λ°ν™
     - `get_restaurants_count()`: λ§¤μ¥ μ λ°ν™
   - **μμ΅΄μ„±**: `RestaurantCache` (μ‹±κΈ€ν†¤)

2. **`MetricsService`** (`services/metrics_service.py`)
   - **λ‹¨μΌ μ±…μ„**: λ©”νΈλ¦­ μμ§‘ λ° κ΄€λ¦¬ λΉ„μ¦λ‹μ¤ λ΅μ§λ§ λ‹΄λ‹Ή
   - **μ£Όμ” λ©”μ„λ“**:
     - `increment_request()`: μ”μ²­ μ μ¦κ°€
     - `increment_error()`: μ—λ¬ μ μ¦κ°€
     - `add_response_time()`: μ‘λ‹µ μ‹κ°„ μ¶”κ°€
     - `get_metrics()`: λ©”νΈλ¦­ μ •λ³΄ λ°ν™
     - `get_health_metrics()`: ν—¬μ¤ μ²΄ν¬μ© λ©”νΈλ¦­ λ°ν™
   - **μμ΅΄μ„±**: `MetricsCollector` (μ‹±κΈ€ν†¤)

3. **`HealthCheckService`** (`services/health_check_service.py`)
   - **λ‹¨μΌ μ±…μ„**: ν—¬μ¤ μ²΄ν¬ κ΄€λ ¨ λΉ„μ¦λ‹μ¤ λ΅μ§λ§ λ‹΄λ‹Ή
   - **μ£Όμ” λ©”μ„λ“**:
     - `check_filesystem()`: νμΌ μ‹μ¤ν… μ²΄ν¬
     - `check_data_load()`: λ°μ΄ν„° λ΅λ“ μ²΄ν¬
     - `perform_health_check()`: μ „μ²΄ ν—¬μ¤ μ²΄ν¬ μν–‰
   - **μμ΅΄μ„±**: `RestaurantService` (μƒμ„±μ μ£Όμ…)

---

### 3. μμ΅΄μ„± μ£Όμ… λ„μ… β…

#### λ¬Έμ μ 
- μ „μ—­ λ³€μμ— μ§μ ‘ μμ΅΄ (`cache`, `metrics`)
- ν…μ¤νΈ μ‹ μ „μ—­ μƒνƒ λ³€κ²½ ν•„μ”
- λ¨ν‚Ή μ–΄λ ¤μ›€

#### ν•΄κ²° λ°©λ²•
- **μ„λΉ„μ¤ λ μ΄μ–΄λ΅ μμ΅΄μ„± μΊ΅μν™”**
  - κ° μ„λΉ„μ¤κ°€ λ‚΄λ¶€μ μΌλ΅ μ‹±κΈ€ν†¤ μ‚¬μ©
  - μ™Έλ¶€μ—μ„λ” μ„λΉ„μ¤ μΈν„°νμ΄μ¤λ§ μ‚¬μ©
  - μƒμ„±μ μ£Όμ…μΌλ΅ μμ΅΄μ„± λ…μ‹ (`HealthCheckService`)

#### λ³€κ²½ μ‚¬ν•­
```python
# μ΄μ „ (μ „μ—­ λ³€μ μ§μ ‘ μ‚¬μ©)
cache = get_cache()
metrics = get_metrics()

def api_restaurants():
    restaurants = cache.get_data()
    metrics.increment_request()
    ...

# μ΄ν›„ (μ„λΉ„μ¤ λ μ΄μ–΄ μ‚¬μ©)
restaurant_service = RestaurantService()
metrics_service = MetricsService()
health_check_service = HealthCheckService(restaurant_service)

def api_restaurants():
    restaurants = restaurant_service.get_all_restaurants()
    metrics_service.increment_request()
    ...
```

---

## π“ μƒμ„±λ νμΌ

### μ„λΉ„μ¤ λ μ΄μ–΄
1. **`services/__init__.py`**
   - μ„λΉ„μ¤ λ¨λ“ μ΄κΈ°ν™”
   - κ³µκ° API μ •μ

2. **`services/restaurant_service.py`**
   - `RestaurantService` ν΄λμ¤
   - λ§¤μ¥ λ°μ΄ν„° κ΄€λ¦¬ λΉ„μ¦λ‹μ¤ λ΅μ§

3. **`services/metrics_service.py`**
   - `MetricsService` ν΄λμ¤
   - λ©”νΈλ¦­ μμ§‘ λ° κ΄€λ¦¬ λΉ„μ¦λ‹μ¤ λ΅μ§

4. **`services/health_check_service.py`**
   - `HealthCheckService` ν΄λμ¤
   - ν—¬μ¤ μ²΄ν¬ λΉ„μ¦λ‹μ¤ λ΅μ§

---

## π”„ μμ •λ νμΌ

### `app.py`
- μ„λΉ„μ¤ λ μ΄μ–΄ import μ¶”κ°€
- μ „μ—­ λ³€μ μ κ±° (`cache`, `metrics`)
- μ„λΉ„μ¤ μΈμ¤ν„΄μ¤ μƒμ„± λ° μ‚¬μ©
- λΌμ°νΈ ν•Έλ“¤λ¬ λ‹¨μν™”
- ν—¬νΌ ν•¨μ μ κ±° (`_get_restaurants_data`, `_check_filesystem_health`, `_check_data_load_health`)

---

## π“ κ°μ„  ν¨κ³Ό

### λ‹¨μΌ μ±…μ„ μ›μΉ™ μ¤€μ
- β… κ° μ„λΉ„μ¤ ν΄λμ¤κ°€ ν•λ‚μ μ±…μ„λ§ λ‹΄λ‹Ή
- β… λΌμ°νΈ ν•Έλ“¤λ¬λ” μ”μ²­/μ‘λ‹µ μ²λ¦¬λ§ λ‹΄λ‹Ή
- β… λΉ„μ¦λ‹μ¤ λ΅μ§μ΄ μ„λΉ„μ¤ λ μ΄μ–΄λ΅ λ¶„λ¦¬

### ν…μ¤νΈ μ©μ΄μ„± ν–¥μƒ
- β… μ„λΉ„μ¤ ν΄λμ¤λ¥Ό λ¨ν‚Ήν•μ—¬ ν…μ¤νΈ κ°€λ¥
- β… μ „μ—­ μƒνƒ μμ΅΄μ„± μ κ±°
- β… μμ΅΄μ„± μ£Όμ…μΌλ΅ ν…μ¤νΈ κ²©λ¦¬ κ°€λ¥

### μ μ§€λ³΄μμ„± ν–¥μƒ
- β… λΉ„μ¦λ‹μ¤ λ΅μ§ λ³€κ²½ μ‹ μ„λΉ„μ¤ ν΄λμ¤λ§ μμ •
- β… λΌμ°νΈ ν•Έλ“¤λ¬μ™€ λΉ„μ¦λ‹μ¤ λ΅μ§ λ¶„λ¦¬λ΅ κ°€λ…μ„± ν–¥μƒ
- β… κ° μ„λΉ„μ¤μ μ±…μ„μ΄ λ…ν™•ν•μ—¬ μ΄ν•΄ν•κΈ° μ‰¬μ›€

### ν™•μ¥μ„± ν–¥μƒ
- β… μƒλ΅μ΄ λΉ„μ¦λ‹μ¤ λ΅μ§ μ¶”κ°€ μ‹ μ„λΉ„μ¤ ν΄λμ¤λ§ μ¶”κ°€
- β… μ„λΉ„μ¤ μΈν„°νμ΄μ¤λ΅ ν™•μ¥ κ°€λ¥
- β… μμ΅΄μ„± μ£Όμ…μΌλ΅ μ μ—°ν• κµ¬μ΅°

---

## π§ ν…μ¤νΈ μƒνƒ

### Import ν…μ¤νΈ
- β… λ¨λ“  μ„λΉ„μ¤ λ¨λ“ import μ„±κ³µ
- β… `app.py` import μ„±κ³µ
- β… μμ΅΄μ„± μ£Όμ… μ •μƒ μ‘λ™ ν™•μΈ

### λ‹¤μ λ‹¨κ³„
- μ„λΉ„μ¤ ν΄λμ¤μ— λ€ν• λ‹¨μ„ ν…μ¤νΈ μ‘μ„± ν•„μ”
- ν†µν•© ν…μ¤νΈ μ—…λ°μ΄νΈ ν•„μ”

---

## π“ λ‹¤μ μ‘μ—…

### 2.2 Open/Closed Principle (κ°λ°©-νμ‡„ μ›μΉ™)
- [ ] μΈν„°νμ΄μ¤/μ¶”μƒ ν΄λμ¤ λ„μ…
- [ ] μ „λµ ν¨ν„΄ μ μ©

### 2.3 Liskov Substitution Principle (λ¦¬μ¤μ½”ν”„ μΉν™ μ›μΉ™)
- [ ] μ¶”μƒ ν΄λμ¤/μΈν„°νμ΄μ¤ μ •μ
- [ ] κµ¬ν„ ν΄λμ¤λ“¤μ΄ μΈν„°νμ΄μ¤ κ³„μ•½ μ¤€μ ν™•μΈ

### 2.4 Interface Segregation Principle (μΈν„°νμ΄μ¤ λ¶„λ¦¬ μ›μΉ™)
- [ ] μΈν„°νμ΄μ¤ μ„Έλ¶„ν™”
- [ ] ν΄λΌμ΄μ–ΈνΈκ°€ μ‚¬μ©ν•μ§€ μ•λ” λ©”μ„λ“ μ κ±°

---

## β… μ²΄ν¬λ¦¬μ¤νΈ

- [x] ν΄λμ¤/ν•¨μ μ±…μ„ λ¶„λ¦¬
- [x] `app.py`μ λΌμ°νΈ ν•Έλ“¤λ¬μ™€ λΉ„μ¦λ‹μ¤ λ΅μ§ λ¶„λ¦¬
- [x] λ°μ΄ν„° λ΅λ”©κ³Ό κ²€μ¦ λ΅μ§ λ¶„λ¦¬
- [x] λ©”νΈλ¦­ μμ§‘κ³Ό μ‘λ‹µ μƒμ„± λ¶„λ¦¬
- [x] μ„λΉ„μ¤ λ μ΄μ–΄ λ„μ…
- [x] `RestaurantService` ν΄λμ¤ μƒμ„±
- [x] `MetricsService` ν΄λμ¤ μƒμ„±
- [x] `HealthCheckService` ν΄λμ¤ μƒμ„±
- [x] μμ΅΄μ„± μ£Όμ… λ„μ…
- [x] μ „μ—­ λ³€μ μμ΅΄μ„± μ κ±°
- [x] μƒμ„±μ μ£Όμ… μ‚¬μ©
- [x] ν…μ¤νΈ κ°€λ¥ν• κµ¬μ΅°λ΅ κ°μ„ 

---

**λ¦¬ν¬νΈ μ‘μ„±μΌ**: 2025λ…„ 12μ›” 19μΌ  
**μ‘μ„±μ**: ν”„λ΅μ νΈ ν€  
**λ‹¤μ μ—…λ°μ΄νΈ**: Open/Closed Principle μ μ© ν›„

